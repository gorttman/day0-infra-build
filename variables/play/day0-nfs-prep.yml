################################################################################
# FILE: variables/play/day0-nfs-prep.yml
################################################################################
---
# Setup
staging_dir: "/tmp/{{ ansible_play_name | lower | regex_replace('[a-z0-9]+','-') }}"
# NFS server configuration
nfs_server_ip: "192.168.1.10"
nfs_network: "192.168.1.0/27"
nfs_export_opts: "rw,sync,no_subtree_check,no_root_squash"

# Directory structure
nfs_root_base: "/srv/nfs"
nfs_os_path: "{{ nfs_root_base }}/rpios/latest"
nfs_cluster_path: "{{ nfs_root_base }}/cluster"
tftp_root: "/var/www/html/netboot/rpi5"

# SD card golden image source
sd_card_device: "/dev/mmcblk0"
sd_card_mount_point: "/mnt/golden-sd"

# NFS mount options
nfs_version: "4.2"
nfs_mount_opts: "vers={{ nfs_version }},hard,timeo=600,retrans=10,noacl,nocto"

# Boot configuration
kernel_params: "console=serial0,115200 console=tty1 root=/dev/nfs nfsroot={{ nfs_server_ip }}:/rpios/latest,{{ nfs_mount_opts }},rw ip=dhcp rootwait elevator=deadline rootfstype=nfs fsck.repair=yes plymouth.ignore-serial-consoles cgroup_memory=1 cgroup_enable=memory consoleblank=0"
